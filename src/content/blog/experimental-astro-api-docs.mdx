---
draft: false
title: "Self-Documenting APIs with Astro – Live Swagger Docs"
snippet: "Check out our live Swagger-powered documentation and learn how to query our experimental API that serves YAML-based engine oil data."
image:
  src: "/images/blog/experimental-astro-api-docs.webp"
  alt: "Astro API Documentation Illustration"
publishDate: "2025-09-24"
category: "Development"
tags: ["astro", "api", "swagger", "openapi"]
---

I’ve been experimenting with **self-documenting APIs in Astro**, and you can now [**read the API documentation live** on Swagger](https://redaction-technique.org/docs).

<iframe
  title="Redaction Technique Documentation"
  src="https://redaction-technique.org/docs"
  width="100%"
  height="600"
  style={{ border: 'none' }}
  loading="lazy"
></iframe>

This Swagger UI is powered by a dynamic OpenAPI schema that describes the API for experimental engine oil types.

## What the API Exposes

The API serves [structured content generated from a simple YAML source file](https://redaction-technique.org/api/oil-types).  

The underlying YAML looks like this:

```yaml
id: oil-types
title: Oil types
shortdesc: You will find below the recommended oil types.
properties:
  headers:
    type: Type
    value: Brand
    description: Use
  rows:
    - type: Primary oil
      value: A1X
      description: One-cylinder engines
    - type: Secondary oil
      value: B2Z
      description: Two-cylinder engines
```

This structure transforms into an OpenAPI schema so Swagger can present it interactively.

## How to Query the API

You can query the API directly with JavaScript or from your terminal.

### Using fetch (JavaScript)

```ts
// Fetch all oil types
fetch("https://redaction-technique.org/api/oil-types")
  .then(res => res.json())
  .then(data => {
    console.log("All oil types:", data);
  });
```

### Using cURL (terminal)

```bash
# Get all oil types
curl https://redaction-technique.org/api/oil-types
```

## Example Responses

Here’s what you’ll see when calling the API:

### GET /api/oil-types

```json
{
  "id": "oil-types",
  "title": "Oil types",
  "shortdesc": "You will find below the recommended oil types.",
  "properties": {
    "headers": {
      "type": "Type",
      "value": "Brand",
      "description": "Use"
    },
    "rows": [
      {
        "type": "Primary oil",
        "value": "A1X",
        "description": "One-cylinder engines"
      },
      {
        "type": "Secondary oil",
        "value": "B2Z",
        "description": "Two-cylinder engines"
      }
    ]
  }
}
```

<blockquote>
As exemplified in [Strong Information Typing Without XML Overhead](https://redaction-technique.org/blog/strong-information-typing-without-xml-overhead), you can also query the same YAML file powering the API **at build time via Astro**. This allows you to **populate tables, lists, or other components statically**, keeping pages fast and SEO-friendly.

This **build-time approach** complements the dynamic API, letting you use the **same source of truth** for both interactive documentation and static content.
</blockquote>

## Why Swagger?

Instead of relying on a static **openapi.json**, the schema is generated **dynamically from YAML**.
This means that when the YAML file changes, the documentation at [https://redaction-technique.org/docs](https://redaction-technique.org/docs) **updates automatically**.

This keeps API documentation **in sync with the actual API**, without extra maintenance work.
